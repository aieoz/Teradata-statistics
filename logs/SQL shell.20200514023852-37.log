2020-05-14 02:38:52,634 - teradata.udaexec - INFO - Initializing UdaExec...
2020-05-14 02:38:52,634 - teradata.udaexec - INFO - Reading config files: ['/etc/udaexec.ini: Not Found', '/home/kamil/udaexec.ini: Not Found', '/home/kamil/Pulpit/Teradata/Repo/Teradata-statistics/udaexec.ini: Not Found']
2020-05-14 02:38:52,634 - teradata.udaexec - INFO - Found run number file: "/home/kamil/Pulpit/Teradata/Repo/Teradata-statistics/.runNumber"
2020-05-14 02:38:52,634 - teradata.udaexec - INFO - Cleaning up log files older than 90 days.
2020-05-14 02:38:52,634 - teradata.udaexec - INFO - Removed 0 log files.
2020-05-14 02:38:52,652 - teradata.udaexec - INFO - Checkpoint file not found: /home/kamil/Pulpit/Teradata/Repo/Teradata-statistics/SQL shell.checkpoint
2020-05-14 02:38:52,654 - teradata.udaexec - INFO - No previous checkpoint found, executing from beginning...
2020-05-14 02:38:52,654 - teradata.udaexec - INFO - Execution Details:
/********************************************************************************
 * Application Name: SQL shell
 *          Version: 1.0
 *       Run Number: 20200514023852-37
 *             Host: kamil-MS-7A34
 *         Platform: Linux-4.15.0-91-generic-x86_64-with-Ubuntu-18.04-bionic
 *          OS User: kamil
 *   Python Version: 3.6.9
 *  Python Compiler: GCC 8.4.0
 *     Python Build: ('default', 'Apr 18 2020 01:56:04')
 *  UdaExec Version: 15.10.0.21
 *     Program Name: script.py
 *      Working Dir: /home/kamil/Pulpit/Teradata/Repo/Teradata-statistics
 *      Git Version: git version 2.17.1
 *     Git Revision: 181db07
 *        Git Dirty: True [ M libs/analysis/daily_usage.py, M libs/init_db.sql, M libs/samples.sql, M libs/utils.py, M script.py, M settings.json,?? .runNumber,?? logs/,?? sqls/]
 *          Log Dir: /home/kamil/Pulpit/Teradata/Repo/Teradata-statistics/logs
 *         Log File: /home/kamil/Pulpit/Teradata/Repo/Teradata-statistics/logs/SQL shell.20200514023852-37.log
 *     Config Files: ['/etc/udaexec.ini: Not Found', '/home/kamil/udaexec.ini: Not Found', '/home/kamil/Pulpit/Teradata/Repo/Teradata-statistics/udaexec.ini: Not Found']
 *      Query Bands: ApplicationName=SQL shell;Version=1.0;JobID=20200514023852-37;ClientUser=kamil;Production=False;udaAppLogFile=/home/kamil/Pulpit/Teradata/Repo/Teradata-statistics/logs/SQL shell.20200514023852-37.log;gitRevision=181db07;gitDirty=True;UtilityName=PyTd;UtilityVersion=15.10.0.21
********************************************************************************/
2020-05-14 02:38:52,655 - teradata.udaexec - INFO - Creating connection: {'method': 'odbc', 'system': '192.168.0.110', 'username': 'dbc', 'password': 'XXXXXX'}
2020-05-14 02:38:52,656 - teradata.tdodbc - INFO - Loading ODBC Library: /opt/teradata/client/ODBC_64/lib/libodbc.so
2020-05-14 02:38:52,661 - teradata.tdodbc - INFO - Available drivers: Teradata Database ODBC Driver 16.20, 
2020-05-14 02:38:52,811 - teradata.udaexec - INFO - Connection successful. Duration: 0.156 seconds. Details: {'method': 'odbc', 'system': '192.168.0.110', 'username': 'dbc', 'password': 'XXXXXX'}
2020-05-14 02:38:52,822 - teradata.udaexec - INFO - Query Successful. Duration: 0.010 seconds, Rows: 8, Query: SELECT TableName FROM DBC.TablesV WHERE TableKind = 'T' AND DataBaseName='movies'
2020-05-14 02:38:52,934 - teradata.udaexec - INFO - Query Successful. Duration: 0.106 seconds, Rows: 31, Query: SELECT DISTINCT CAST((calendar_date (FORMAT 'YYYY-mm-dd')) AS VARCHAR(10)) FROM Sys_Calendar.Calendar AS CALENDAR
LEFT OUTER JOIN 
(SELECT * FROM TDSP_ANALYSIS.daily_usage) AS MEASURES 
ON calendar_date = measure_date
WHERE calendar_date<=cast('2020-05-14' as DATE) 
AND calendar_date>=cast('2020-04-14' as DATE)
AND
(complete=0 OR complete IS NULL);
2020-05-14 02:38:53,009 - teradata.udaexec - INFO - Query Successful. Duration: 0.071 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-17' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-17' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-17' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,096 - teradata.udaexec - INFO - Query Successful. Duration: 0.086 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-09' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-09' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-09' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,162 - teradata.udaexec - INFO - Query Successful. Duration: 0.066 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-01' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-01' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-01' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,253 - teradata.udaexec - INFO - Query Successful. Duration: 0.091 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-04' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-04' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-04' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,315 - teradata.udaexec - INFO - Query Successful. Duration: 0.061 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-27' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-27' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-27' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,376 - teradata.udaexec - INFO - Query Successful. Duration: 0.061 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-07' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-07' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-07' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,437 - teradata.udaexec - INFO - Query Successful. Duration: 0.060 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-11' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-11' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-11' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,509 - teradata.udaexec - INFO - Query Successful. Duration: 0.071 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-18' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-18' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-18' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,570 - teradata.udaexec - INFO - Query Successful. Duration: 0.060 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-14' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-14' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-14' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,629 - teradata.udaexec - INFO - Query Successful. Duration: 0.059 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-15' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-15' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-15' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,690 - teradata.udaexec - INFO - Query Successful. Duration: 0.060 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-22' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-22' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-22' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,752 - teradata.udaexec - INFO - Query Successful. Duration: 0.061 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-02' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-02' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-02' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,812 - teradata.udaexec - INFO - Query Successful. Duration: 0.059 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-25' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-25' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-25' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,902 - teradata.udaexec - INFO - Query Successful. Duration: 0.089 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-12' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-12' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-12' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:53,967 - teradata.udaexec - INFO - Query Successful. Duration: 0.065 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-28' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-28' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-28' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,058 - teradata.udaexec - INFO - Query Successful. Duration: 0.090 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-30' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-30' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-30' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,119 - teradata.udaexec - INFO - Query Successful. Duration: 0.061 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-05' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-05' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-05' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,179 - teradata.udaexec - INFO - Query Successful. Duration: 0.060 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-23' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-23' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-23' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,243 - teradata.udaexec - INFO - Query Successful. Duration: 0.064 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-08' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-08' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-08' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,302 - teradata.udaexec - INFO - Query Successful. Duration: 0.058 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-26' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-26' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-26' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,364 - teradata.udaexec - INFO - Query Successful. Duration: 0.062 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-20' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-20' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-20' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,451 - teradata.udaexec - INFO - Query Successful. Duration: 0.087 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-10' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-10' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-10' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,514 - teradata.udaexec - INFO - Query Successful. Duration: 0.062 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-16' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-16' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-16' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,574 - teradata.udaexec - INFO - Query Successful. Duration: 0.060 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-29' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-29' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-29' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,663 - teradata.udaexec - INFO - Query Successful. Duration: 0.089 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-19' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-19' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-19' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,724 - teradata.udaexec - INFO - Query Successful. Duration: 0.061 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-13' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-13' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-13' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,783 - teradata.udaexec - INFO - Query Successful. Duration: 0.058 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-06' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-06' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-06' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,873 - teradata.udaexec - INFO - Query Successful. Duration: 0.089 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-21' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-21' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-21' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:54,934 - teradata.udaexec - INFO - Query Successful. Duration: 0.061 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-05-03' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-05-03' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-05-03' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:55,020 - teradata.udaexec - INFO - Query Successful. Duration: 0.086 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-24' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-24' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-24' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:55,086 - teradata.udaexec - INFO - Query Successful. Duration: 0.066 seconds, Rows: 24, Query: MERGE INTO TDSP_ANALYSIS.daily_usage as daily_usage USING
(

	SELECT CAST('2020-04-14' AS DATE) AS t_measure_date, 
	 SYSHOURS.HOUR_ID as t_measure_hour,
	 'movies' as t_table_name, 
     'movies' as t_database_name,
	 CASE 
	  	WHEN CAST('2020-04-14' AS DATE)<CURRENT_TIMESTAMP THEN 1
	 ELSE 0
	 END AS t_complete,
	 ZEROIFNULL(LOGS.TOTAL) as t_uses_total
	 FROM TDSP_ANALYSIS.system_hours AS SYSHOURS 
	LEFT OUTER JOIN 
	(
		SELECT EXTRACT(HOUR FROM CollectTimeStamp)
		AS "DHOUR", COUNT(QueryID) AS TOTAL FROM DBC.DBQLObjTbl 
		GROUP BY DHOUR
		WHERE LOWER(ObjectTableName)=LOWER('movies') 
		AND LOWER(ObjectDatabaseName)=LOWER('movies')
		AND CollectTimeStamp=CAST('2020-04-14' AS DATE)
	) AS LOGS ON DHOUR = HOUR_ID

) AS t_
ON measure_date=t_measure_date AND measure_hour=t_measure_hour AND table_name=t_table_name AND database_name=t_database_name

WHEN MATCHED THEN
	UPDATE SET complete=t_complete, uses_total=t_uses_total

WHEN NOT MATCHED THEN
	INSERT (measure_date, measure_hour, database_name, table_name, complete, uses_total)
	VALUES (t_measure_date, t_measure_hour, t_database_name, t_table_name, t_complete, t_uses_total);

2020-05-14 02:38:55,102 - teradata.udaexec - INFO - UdaExec exiting.
